(()=>{"use strict";function e(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,i)}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const n=window.wp.element;function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],_n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(_n=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);_n=!0);}catch(s){r=!0,i=s}finally{try{_n||null==o.return||o.return()}finally{if(r)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const o=window.wp.i18n;var s,l,c=function(e){var t=e.id,r=e.label,i=e.detailsLabel,a="sensei-exit-reason__".concat(t),o="".concat(a,"-details");return(0,n.createElement)("div",{className:"sensei-exit-survey__item"},(0,n.createElement)("input",{id:a,type:"radio",name:"reason",value:t,className:"sensei-exit-survey__radio"}),(0,n.createElement)("label",{htmlFor:a}," ",r),i&&(0,n.createElement)("div",{className:"sensei-exit-survey__details"},(0,n.createElement)("input",{id:o,name:"details-".concat(t),defaultValue:"",type:"text",placeholder:i})))},__=o.__,u=[{id:"no-longer-need",label:__("I no longer need the plugin","sensei-lms")},{id:"not-working",label:__("The plugin isn't working","sensei-lms"),detailsLabel:__("What isn't working properly?","sensei-lms")},{id:"different-functionality",label:__("I'm looking for different functionality","sensei-lms"),detailsLabel:__("What functionality is missing?","sensei-lms")},{id:"found-better-plugin",label:__("I found a better plugin","sensei-lms"),detailsLabel:__("What's the name of the plugin?","sensei-lms")},{id:"temporary",label:__("It's a temporary deactivation","sensei-lms")},{id:"other",label:"Other",detailsLabel:__("Why are you deactivating?","sensei-lms")}],d=o.__,m=function(e){var t=e.submit,i=e.skip,o=(0,n.useRef)(null),s=a((0,n.useState)(null),2)[1],l=(0,n.useCallback)((function(e){e.preventDefault();var n=new window.FormData(o.current),r=n.get("reason");t({reason:r,details:r&&n.get("details-".concat(r))})}),[t]),m=!1;if(o.current){var f,v=new window.FormData(o.current),p="details-".concat(v.get("reason")),y=(null===(f=o.current)||void 0===f?void 0:f.elements[p])||!1;m=!(!v.get("reason")||y&&""===v.get(p).trim())}return(0,n.createElement)("form",{onChange:function(){var e=new window.FormData(o.current);s(e.values())},className:"sensei-modal sensei-exit-survey",ref:o,onSubmit:l},(0,n.createElement)("div",{className:"sensei-exit-survey__content"},(0,n.createElement)("h2",null,d("Quick Feedback","sensei-lms")),(0,n.createElement)("p",null,d("If you have a moment, please let us know why you are deactivating so that we can work to improve our product.","sensei-lms")),u.map((function(e){return(0,n.createElement)(c,r({key:e.id},e))}))),(0,n.createElement)("div",{className:"sensei-exit-survey__buttons"},(0,n.createElement)("button",{className:"button button-primary",type:"submit",disabled:!m},d("Submit Feedback","sensei-lms")),(0,n.createElement)("button",{className:"button button-secondary",onClick:i,type:"button"},d("Skip Feedback","sensei-lms"))))};l=function r(i){var a=this,o=i.href;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),t(this,"href",void 0),t(this,"container",void 0),t(this,"open",(function(){var e=document.querySelector("#sensei-exit-survey");e||((e=document.createElement("div")).setAttribute("id","sensei-exit-survey-modal"),document.body.appendChild(e)),a.container=e,(0,n.render)((0,n.createElement)(m,{submit:a.submitExitSurvey,skip:a.closeAndDeactivate}),e)})),t(this,"submitExitSurvey",function(){var t,n=(t=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new window.FormData).append("action","exit_survey"),r.append("_wpnonce",null===(n=window.sensei_exit_survey)||void 0===n?void 0:n.nonce),r.append("reason",t.reason),r.append("details",t.details),e.next=7,window.fetch(window.ajaxurl,{method:"POST",body:r});case 7:a.closeAndDeactivate();case 8:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(i,a){var o=t.apply(n,r);function s(t){e(o,i,a,s,l,"next",t)}function l(t){e(o,i,a,s,l,"throw",t)}s(void 0)}))});return function(_x){return n.apply(this,arguments)}}()),t(this,"closeAndDeactivate",(function(){a.container.remove(),window.location=a.href})),this.href=o},[(s=function(e){return document.querySelector('#the-list [data-slug="'.concat(e,'"] span.deactivate a'))})("sensei-lms"),s("sensei-with-woocommerce-paid-courses"),s("woocommerce-com-woocommerce-paid-courses")].filter((function(e){return!!e})).forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),new l({href:e.target.href}).open()}))}))})();