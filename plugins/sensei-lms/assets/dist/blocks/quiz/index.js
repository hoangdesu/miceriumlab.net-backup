(()=>{var e={42:(e,t)=>{var n;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var r={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var l=s.apply(null,n);l&&e.push(l)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var i in n)r.call(n,i)&&n[i]&&e.push(i);else e.push(n.toString())}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(n=function(){return s}.apply(t,[]))||(e.exports=n)}()},8132:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}const s=window.wp.element,o=window.wp.blocks,l=window.React;var i;function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const c=function(e){return l.createElement("svg",a({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),i||(i=l.createElement("path",{d:"M12 24a12 12 0 1 0 0-24 12 12 0 0 0 0 24Zm-.1-4.723c-2.849 0-4.517-1.072-4.575-3.011 0-.203 0-.405.029-.608 1.208 1.013 2.733 1.65 4.603 1.65 1.64 0 2.733-.695 2.733-1.708 0-.608-.978-.897-2.244-1.274-2.33-.752-5.553-1.736-5.553-5.181 0-2.721 1.957-4.458 5.323-4.458 2.905 0 4.66 1.042 4.689 3.242v.376c-1.496-1.187-3.107-1.794-4.862-1.794-1.64 0-2.848.636-2.848 1.592 0 .55.978.868 2.244 1.273 2.33.753 5.667 1.824 5.667 5.24 0 2.808-2.186 4.66-5.207 4.66Z",fill:"currentColor"})))};var u=["name"];const m=function(e){(0,o.updateCategory)("sensei-lms",{icon:(0,s.createElement)(c,{width:"20",height:"20"})}),e.forEach((function(e){var t=e.name,n=r(e,u);(0,o.registerBlockType)(t,n)}))};function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const v=window.wp.blockEditor,g=window.wp.i18n;var h=n(42),b=n.n(h),__=g.__,E={correct:{title:__("Correct","sensei-lms"),placeholder:__("Enter feedback to be displayed if a student gets this answer right. Type / to choose a block.","sensei-lms")},incorrect:{title:__("Incorrect","sensei-lms"),placeholder:__("Enter feedback to be displayed if a student gets this answer wrong. Type / to choose a block.","sensei-lms")}};const _=function(e){var t=e.type,n=E[t],r=n.title,o=n.placeholder;return(0,s.createElement)("div",{className:b()("sensei-lms-question__answer-feedback","sensei-lms-question__answer-feedback--".concat(t))},(0,s.createElement)("div",{className:"sensei-lms-question__answer-feedback__header"},(0,s.createElement)("span",{className:"sensei-lms-question__answer-feedback__icon"}),(0,s.createElement)("span",null,r)),(0,s.createElement)("div",{className:"sensei-lms-question__answer-feedback__content"},(0,s.createElement)(v.InnerBlocks,{template:[["core/paragraph",{placeholder:o}]],templateInsertUpdatesSelection:!1,templateLock:!1})))};var w,k;function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}const q=function(e){return l.createElement("svg",y({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),w||(w=l.createElement("path",{d:"M12.408 7.277A2.999 2.999 0 0 0 9 10.25h1.5c0-.677.375-1.14.886-1.37.512-.228 1.11-.198 1.614.253.504.45.6 1.04.43 1.574-.171.534-.592.958-1.264 1.033l.021-.002a1.034 1.034 0 0 0-.937.99V14h1.5v-.95c1.02-.28 1.817-.979 2.107-1.888a2.998 2.998 0 0 0-2.449-3.885z"})),k||(k=l.createElement("path",{d:"M6 4c-1.096 0-2 .904-2 2v12c0 1.096.904 2 2 2h12c1.096 0 2-.904 2-2V6c0-1.096-.904-2-2-2H6zm0 1.5h12c.284 0 .5.216.5.5v12a.49.49 0 0 1-.5.5H6a.49.49 0 0 1-.5-.5V6c0-.284.216-.5.5-.5zm5.25 9.5v1.5h1.5V15h-1.5z"})))};var C=g.__,S={parent:["sensei-lms/quiz-question"],category:"sensei-lms",supports:{html:!1},attributes:{id:{type:"integer"}}},N=f(f({},S),{},{name:"sensei-lms/quiz-question-feedback-correct",title:C("Correct Answer Feedback","sensei-lms"),icon:q,description:C("Display correct answer feedback.","sensei-lms"),edit:function(e){return _(f(f({},e),{},{type:"correct"}))},save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)}}),x=f(f({},S),{},{name:"sensei-lms/quiz-question-feedback-incorrect",title:C("Incorrect Answer Feedback","sensei-lms"),icon:q,description:C("Display incorrect answer feedback.","sensei-lms"),edit:function(e){return _(f(f({},e),{},{type:"incorrect"}))},save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)}});const B=window.wp.compose;function P(){return P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},P.apply(this,arguments)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],_n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(_n=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);_n=!0);}catch(i){r=!0,s=i}finally{try{_n||null==l.return||l.return()}finally{if(r)throw s}}return n}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const I=window.wp.data,T=window.lodash;var z=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,r=arguments.length>1?arguments[1]:void 0,s=e[r.type]||e.DEFAULT;return s(r,n)}},M={reducer:z({SET_BLOCK_META:function(e,t){var n=e.clientId,r=e.metadata;return f(f({},t),{},d({},n,f(f({},t[n]||{}),r)))},CLEAR:function(e,t){return t?f(f({},e),{},d({},t,void 0)):{}},DEFAULT:function(e){return e}},{}),actions:{setBlockMeta:function(e,t){return{type:"SET_BLOCK_META",clientId:e,metadata:t}},clear:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"CLEAR",clientId:e}}},selectors:{getBlockMeta:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return r?null===(n=e[t])||void 0===n?void 0:n[r]:e[t]},getMultipleBlockMeta:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!=t&&t.length?(0,T.pick)(e,t):f({},e);return n?(0,T.mapValues)(r,n):r}}},F=function(e,t){if(I.createReduxStore){var n=(0,I.createReduxStore)(e,t);return(0,I.register)(n),n}return(0,I.registerStore)(e,t),e}("sensei/block-metadata",M),j=(0,s.createContext)({}),Q=function(e){var t=(0,I.useSelect)((function(t){return t(F).getBlockMeta(e)}),[e]),n=(0,I.useDispatch)(F).setBlockMeta,r=D(),o=(0,s.useCallback)((function(t){return n(e,t)}),[e,n]);return[(0,s.useMemo)((function(){return f(f({},r),t)}),[t,r]),o]},V=(0,B.createHigherOrderComponent)((function(e){return L((function(t){var n=R(Q(t.clientId),1)[0];return(0,s.createElement)(j.Provider,{value:n},(0,s.createElement)(e,t))}))}),"withBlockMetaProvider"),D=function(){return(0,s.useContext)(j)},L=(0,B.createHigherOrderComponent)((function(e){return function(t){var n=R(Q(t.clientId),2),r=n[0],o=n[1];return(0,s.createElement)(e,P({},t,{meta:r,setMeta:o}))}}),"withBlockMeta"),U=g.__;const G=(0,B.compose)(L)((function(){return(0,s.createElement)("div",{className:b()("sensei-lms-question-description-block")},(0,s.createElement)(v.InnerBlocks,{template:[["core/paragraph",{placeholder:U("Add question description or type / to choose a block.","sensei-lms")}]],templateInsertUpdatesSelection:!1,templateLock:!1}))})),H=JSON.parse('{"name":"sensei-lms/question-description","parent":["sensei-lms/quiz-question"],"category":"sensei-lms","supports":{"html":false},"attributes":{"id":{"type":"integer"}}}');var W=g.__;const Z=f(f({},H),{},{title:W("Description","sensei-lms"),icon:q,usesContext:["sensei-lms/quizId"],description:W("Question Description.","sensei-lms"),edit:G,save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)}});function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const $=function(e){var t=e.icon,n=e.size,r=void 0===n?24:n,o=J(e,["icon","size"]);return(0,s.cloneElement)(t,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({width:r,height:r},o))},X=window.wp.primitives;const ee=(0,s.createElement)(X.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)(X.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"}));const te=(0,s.createElement)(X.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,s.createElement)(X.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"}));var ne=(0,s.createContext)({}),re=g.__,se=function(){var e=(0,s.useContext)(ne).answerFeedback,t=e.showAnswerFeedback,n=e.toggleAnswerFeedback;return(0,s.createElement)("div",{className:b()("sensei-lms-question-block__answer-feedback-toggle",{"is-visible":t})},(0,s.createElement)("button",{className:"sensei-lms-question-block__answer-feedback-toggle__header",onClick:function(){return n(!t)}},re("Answer Feedback","sensei-lms"),(0,s.createElement)($,{className:"sensei-lms-question-block__answer-feedback-toggle__icon",icon:t?ee:te})),(0,s.createElement)("div",{className:"sensei-lms-question-block__answer-feedback-toggle__help"},re("Show feedback to students after they submit the quiz.","sensei-lms")))};const oe=function(){var e=(0,s.useContext)(ne),t=e.answer,n=e.setAttributes,r=e.AnswerBlock,o=e.hasSelected,l=e.canHaveFeedback;return(0,s.createElement)("div",{className:b()("sensei-lms-question-answers-block")},(null==r?void 0:r.edit)&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)(r.edit,{attributes:t,setAttributes:function(e){return n({answer:f(f({},t),e)})},hasSelected:o}),l&&o&&(0,s.createElement)(se,null)))},le=JSON.parse('{"name":"sensei-lms/question-answers","parent":["sensei-lms/quiz-question"],"category":"sensei-lms","supports":{"html":false},"attributes":{}}');var ie=g.__;const ae=f(f({},le),{},{title:ie("Answers","sensei-lms"),icon:q,description:ie("Question Answers.","sensei-lms"),edit:oe,save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)}});function ce(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ue=function(e){return(0,B.createHigherOrderComponent)((function(t){return function(n){return function(e,t){var n=t.attributes,r=t.setMeta;(0,s.useEffect)((function(){var t=me(e(n));r({validationErrors:t})}),[e,n,r])}(e,n),(0,s.createElement)(t,n)}}),"withBlockValidation")},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(e).filter((function(e){return R(e,2)[1]})).map((function(e){return R(e,1)[0]}))},de=function(e){var t=(0,I.useSelect)((function(t){var n=t("core/block-editor"),r=n.getBlockRootClientId(e);return(n.getBlocks(r)||[]).slice(0,n.getBlockIndex(e,r))}),[e]),n=t.reduce((function(e,t){var n;return e+("category-question"===t.attributes.type&&(null===(n=t.attributes.options)||void 0===n?void 0:n.number)||1)}),0);return n+1};const pe=window.wp.keycodes;var fe=["onChange","onKeyDown","value","onEnter","onRemove"];const ve=(0,s.forwardRef)((function(e,t){var n=e.onChange,o=e.onKeyDown,l=e.value,i=e.onEnter,a=e.onRemove,c=r(e,fe);return(0,s.createElement)(v.PlainText,P({ref:t,value:l,onChange:function(e){n(e.replace(/\n/g,""))},onKeyDown:function(e){switch(o&&o(e),e.keyCode){case pe.ENTER:e.preventDefault(),i&&i(e);break;case pe.BACKSPACE:!a||null!=l&&l.length||(e.preventDefault(),a())}}},c,{className:b()("sensei-lms-single-line-input",c.className)}))})),ge=ve;var he=function(e){var t=e.onMount;return(0,s.useEffect)((function(){t()}),[t]),null},be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(0,I.useSelect)((function(e){return e("core/editor").isSavingPost()&&!e("core/editor").isAutosavingPost()}));(0,s.useEffect)((function(){n&&e()}),[n].concat(ce(t)))};const Ee=window.wp.hooks;var _e=g.__;const we=function(){return(0,s.createElement)("div",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--file-upload"},(0,s.createElement)("div",{className:"sensei-lms-question-block__file-input-placeholder"},_e("Browse…","sensei-lms")))},ke=window.wp.components;var ye=g.__,qe=function(e){var t=e.attributes,n=t.before,r=t.after,o=t.gap,l=e.setAttributes,i=e.hasSelected;return(0,s.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--gap-fill"},(0,s.createElement)("li",null,(0,s.createElement)(ve,{className:"sensei-lms-question-block__answer--gap-fill__text",placeholder:ye("Text before the gap","sensei-lms"),value:n,onChange:function(e){return l({before:e})}})),(0,s.createElement)("li",{className:"sensei-lms-question-block__answer--gap-fill__right-answers",onBlur:function(e){var t=e.target;null!=t&&t.value&&(l({gap:[].concat(ce(null!=o?o:[]),[t.value])}),Se(t,""))}},(0,s.createElement)(ke.FormTokenField,{className:"sensei-lms-question-block__text-input-placeholder",value:o||[],label:!1,onChange:function(e){return l({gap:e})}}),i&&(0,s.createElement)("div",{className:"sensei-lms-question-block__answer--gap-fill__hint"},ye("Add right answers. Separate with commas or the Enter key.","sensei-lms"))),(0,s.createElement)("li",null,(0,s.createElement)(ve,{className:"sensei-lms-question-block__answer--gap-fill__text",placeholder:ye("Text after the gap","sensei-lms"),value:r,onChange:function(e){return l({after:e})}})))};qe.view=function(e){var t=e.attributes,n=t.before,r=t.after,o=t.gap;return(0,s.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--gap-fill"},(0,s.createElement)("li",null,n),(0,s.createElement)("li",{className:"sensei-lms-question-block__answer--gap-fill__right-answers sensei-lms-question-block__text-input-placeholder"},o.map((function(e){return(0,s.createElement)("span",{key:e,className:"sensei-lms-question-block__answer--gap-fill__token"},e)}))),(0,s.createElement)("li",null,r))};const Ce=qe;var Se=function(e,t){delete e.value,e.value=t,e.dispatchEvent(new window.Event("change",{bubbles:!0}))},Ne=g.__;const xe=function(){return(0,s.createElement)("div",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--multi-line"},(0,s.createElement)("small",{className:"sensei-lms-question-block__input-label"},Ne("Answer:","sensei-lms")),(0,s.createElement)("div",{className:"sensei-lms-question-block__text-input-placeholder multi-line"}))};const Be=(0,s.createElement)(X.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(X.Path,{d:"M18.3 5.6L9.9 16.9l-4.6-3.4-.9 1.2 5.8 4.3 9.3-12.6z"}));var Pe=["className","isChecked","isCheckbox","children"],Ae=function(e){var t=e.className,n=e.isChecked,o=e.isCheckbox,l=e.children,i=r(e,Pe);return(0,s.createElement)("div",P({className:b()("sensei-lms-question-block__option-toggle",t)},i),(0,s.createElement)("div",{className:b()("sensei-lms-question-block__option-toggle__control",{"is-checked":n,"is-checkbox":o})},n&&o&&Be),l)},Oe=["attributes","setAttributes","hasFocus","hasSelected","isCheckbox"],Re=g.__;const Ie=function(e){var t=e.attributes,n=t.label,o=t.correct,l=e.setAttributes,i=e.hasFocus,a=e.hasSelected,c=e.isCheckbox,u=r(e,Oe),m=(0,s.useRef)(null);(0,s.useEffect)((function(){if(i){var e,t=(null===(e=m.current)||void 0===e?void 0:e.textarea)||m.current;null==t||t.focus()}}),[i,m]);return(0,s.createElement)("div",{className:"sensei-lms-question-block__multiple-choice-answer-option"},(0,s.createElement)(Ae,{isChecked:o,isCheckbox:c}),(0,s.createElement)(ge,P({ref:m,placeholder:Re("Add Answer","sensei-lms"),className:"sensei-lms-question-block__multiple-choice-answer-option__input",onChange:function(e){return l({label:e})},value:n},u)),a&&(0,s.createElement)("div",{className:"sensei-lms-question-block__answer--multiple-choice__toggle__wrapper"},(0,s.createElement)(ke.Button,{isPrimary:!0,className:"sensei-lms-question-block__answer--multiple-choice__toggle",onClick:function(){return l({correct:!o})}},Re(o?"Right":"Wrong","sensei-lms"))))};var Te=[{label:"",correct:!0},{label:"",correct:!1}],ze=function(e){return e.filter((function(e){return e.correct})).length>1},Me=function e(t){var n,r=t.setAttributes,o=t.hasSelected,l=t.attributes.answers,i=void 0===l?[]:l;0===i.length&&(i=Te);var a=ze(i),c=!(null!==(n=i[i.length-1])&&void 0!==n&&n.label),u=ce(i);o&&!c&&u.push({label:"",correct:!1});var m=function(e,t){var n=ce(i);n[e]=f(f({},n[e]),t),r({answers:n})},d=R((0,s.useState)(null),2),p=d[0],v=d[1];return(0,s.createElement)(e.Options,{answers:u},(function(e,t){return(0,s.createElement)(Ie,{hasFocus:t===p,isCheckbox:a,attributes:e,setAttributes:function(e){return m(t,e)},onEnter:function(){return function(e){var t=ce(i);t.splice(e+1,0,{label:"",correct:!1}),r({answers:t}),v(e+1)}(t)},onRemove:function(){return function(e){if(1!==i.length){v(e-1);var t=ce(i);t.splice(e,1),r({answers:t})}}(t)},hasSelected:o})}))};Me.Options=function(e){var t=e.answers,n=e.children;return(0,s.createElement)("ol",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--multiple-choice"},t.map((function(e,t){return(0,s.createElement)("li",{key:t,className:b()("sensei-lms-question-block__answer--multiple-choice__option",{"is-draft":!e.label})},n(e,t))})))},Me.view=function(e){var t=e.attributes.answers,n=void 0===t?[]:t,r=ze(n);return(0,s.createElement)(Me.Options,{answers:n},(function(e){return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(Ae,{isChecked:e.correct,isCheckbox:r}),e.label)}))};const Fe=Me;var je=g.__;const Qe=function(){return(0,s.createElement)("div",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--single-line"},(0,s.createElement)("small",{className:"sensei-lms-question-block__input-label"},je("Answer:","sensei-lms")),(0,s.createElement)("div",{className:"sensei-lms-question-block__text-input-placeholder"}))};var Ve=g.__,De=function(e){var t=e.attributes.correct,n=void 0===t||t,r=e.setAttributes,o=e.hasSelected,l=[{label:Ve("True","sensei-lms"),value:!0},{label:Ve("False","sensei-lms"),value:!1}];return(0,s.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--true-false"},l.map((function(e){var t=e.label,l=e.value;return(0,s.createElement)("li",{key:l,className:"sensei-lms-question-block__answer--true-false__option"},(0,s.createElement)(Ae,{isChecked:n===l},(0,s.createElement)("span",null,t)),o&&(0,s.createElement)("div",{className:"sensei-lms-question-block__answer--multiple-choice__toggle__wrapper"},(0,s.createElement)(ke.Button,{isPrimary:!0,className:"sensei-lms-question-block__answer--true-false__toggle",onClick:function(){return r({correct:l===n?!l:l})}},Ve(n===l?"Right":"Wrong","sensei-lms"))))})))};De.view=function(e){var t=e.attributes.correct,n=void 0===t||t,r=[{label:Ve("True","sensei-lms"),value:!0},{label:Ve("False","sensei-lms"),value:!1}];return(0,s.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--true-false"},r.map((function(e){var t=e.label,r=e.value;return(0,s.createElement)("li",{key:r,className:"sensei-lms-question-block__answer--true-false__option"},(0,s.createElement)(Ae,{isChecked:n===r},(0,s.createElement)("span",null,t)))})))};const Le=De;var Ue=g.__;const Ge=function(e){var t=e.options.teacherNotes,n=e.setOptions;return(0,s.createElement)(ke.TextareaControl,{label:Ue("Grading Notes","sensei-lms"),onChange:function(e){return n({teacherNotes:e})},value:t||"",help:Ue("Displayed to the teacher when grading the question.","sensei-lms")})};var He=n(1719),We=["className","id","label","value","help","allowReset","resetLabel","onChange","suffix","hideLabelFromVision"],Ze=g.__;const Ke=function(e){var t=e.className,n=e.id,o=e.label,l=e.value,i=e.help,a=e.allowReset,c=void 0!==a&&a,u=e.resetLabel,m=e.onChange,d=e.suffix,p=e.hideLabelFromVision,f=r(e,We);return(0,s.createElement)(ke.BaseControl,{id:n,label:o,help:i,hideLabelFromVision:p},(0,s.createElement)("div",{className:"sensei-number-control"},(0,s.createElement)("div",{className:"sensei-number-control__input-container"},(0,s.createElement)("input",P({className:b()("sensei-number-control__input components-text-control__input",t),type:"number",id:n,onChange:function(e){m(parseInt(e.target.value,10)||f.min||0)},value:null===l?"":l},f)),d&&(0,s.createElement)("span",{className:"sensei-number-control__input-suffix"},d)),c&&(0,s.createElement)(ke.Button,{className:"sensei-number-control__button",isSmall:!0,isSecondary:!0,onClick:function(){return m(null)}},u||Ze("Reset","sensei-lms"))))};var _n=g._n,Je=function(e){var t=(0,s.useMemo)((function(){return(0,He.v4)()}),[]);return(0,s.createElement)(Ke,P({id:t,min:0,step:1},e,{suffix:_n("Point","Points",e.value,"sensei-lms")}))},Ye=g.__;const $e=function(e){var t=e.options.grade,n=void 0===t?1:t,r=e.setOptions;return(0,s.createElement)(Je,{label:Ye("Grade","sensei-lms"),value:n,onChange:function(e){return r({grade:null!=e?e:1})},allowReset:!0})};var Xe=g.__;const et=function(e){var t=e.options.randomOrder,n=void 0!==t&&t,r=e.setOptions;return(0,s.createElement)(ke.CheckboxControl,{label:Xe("Random Order","sensei-lms"),checked:n,onChange:function(e){return r({randomOrder:e})}})};var tt=g.__,nt={"multiple-choice":{title:tt("Multiple Choice","sensei-lms"),description:tt("Select from a list of options.","sensei-lms"),edit:Fe,view:Fe.view,settings:[et],feedback:!0,validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.answers,n=void 0===t?[]:t;return{noAnswers:n.filter((function(e){return e.label})).length<2,noRightAnswer:!n.some((function(e){return e.correct&&e.label})),noRightAnswerWhitespace:!n.some((function(e){return e.correct&&e.label.trim()})),noWrongAnswer:!n.some((function(e){return!e.correct&&e.label})),noWrongAnswerWhitespace:!n.some((function(e){return!e.correct&&e.label.trim()}))}},messages:{noAnswers:tt("Add at least one right and one wrong answer.","sensei-lms"),noRightAnswer:tt("Add a right answer to this question.","sensei-lms"),noRightAnswerWhitespace:tt("The value of the right answer can not be blank space.","sensei-lms"),noWrongAnswer:tt("Add a wrong answer to this question. Value can not be blank space.","sensei-lms"),noWrongAnswerWhitespace:tt("The value of the wrong answer can not be blank space.","sensei-lms")}},boolean:{title:tt("True/False","sensei-lms"),description:tt("Select whether a statement is true or false.","sensei-lms"),edit:Le,view:Le.view,feedback:!0,settings:[]},"gap-fill":{title:tt("Gap Fill","sensei-lms"),description:tt("Fill in the blank.","sensei-lms"),edit:Ce,view:Ce.view,feedback:!0,settings:[],validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.before,n=e.after,r=e.gap;return{noGap:!(null!=r&&r.filter((function(e){return""!==e})).length),noGapWhitespace:!(null!=r&&r.filter((function(e){return""!==e.trim()})).length),noBeforeAndNoAfter:!t&&!n,noBeforeAndNoAfterWhitespace:!(null!=t&&t.trim()||null!=n&&n.trim())}},messages:{noGap:tt("Add a right answer to this question.","sensei-lms"),noGapWhitespace:tt("The value of a right answer can not be blank space.","sensei-lms"),noBeforeAndNoAfter:tt("Add text before or after the gap. Value can not be blank space.","sensei-lms"),noBeforeAndNoAfterWhitespace:tt("Value of the text before or after the gap can not be blank space.","sensei-lms")}},"single-line":{title:tt("Single Line","sensei-lms"),description:tt("Short answer to an open-ended question.","sensei-lms"),edit:Qe,view:Qe,settings:[Ge]},"multi-line":{title:tt("Multi Line","sensei-lms"),description:tt("Long answer to an open-ended question.","sensei-lms"),edit:xe,view:xe,settings:[Ge]},"file-upload":{title:tt("File Upload","sensei-lms"),description:tt("Upload a file or document.","sensei-lms"),edit:we,view:we,settings:[Ge]}},rt={QuestionGradingNotesSettings:Ge};const st=(0,Ee.applyFilters)("sensei-lms.Question.questionTypes",nt,rt);const ot=(0,s.createElement)(X.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(X.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"}));var lt,it;function at(){return at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},at.apply(this,arguments)}const ct=function(e){return l.createElement("svg",at({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),lt||(lt=l.createElement("path",{d:"M13 7h-2v6h2V7zm0 8h-2v2h2v-2z"})),it||(it=l.createElement("path",{d:"M12 4.75a7.25 7.25 0 1 0 0 14.5 7.25 7.25 0 0 0 0-14.5zM3.25 12a8.75 8.75 0 1 1 17.5 0 8.75 8.75 0 0 1-17.5 0z"})))};var ut=g.__,mt=function(){return(0,s.createElement)("div",{className:"sensei-lms-question-block__notice"},(0,s.createElement)($,{icon:ot}),(0,s.createElement)(ke.Tooltip,{text:ut("Any updates made to this question will also update it in any other quiz that includes it.","sensei-lms")},(0,s.createElement)("span",null,ut("Shared Question","sensei-lms"))))},dt=function(e){var t=e.attributes.type,n=e.meta,r=n.validationErrors,o=n.showValidationErrors,l=e.getErrorMessages;if(!o||null==r||!r.length)return null;var i=l(r,t);return(0,s.createElement)(pt,{errors:i})},pt=function(e){var t=e.errors,n=void 0===t?[]:t;if(!n||!n.length)return null;var r=n[0];return(0,s.createElement)(ke.Notice,{isDismissible:!1,status:"warning",className:"sensei-lms-block-validation-notice"},(0,s.createElement)(ct,{className:"sensei-lms-block-validation-notice__icon"}),r)},ft=function(e){var t=e.value,n=e.onChange;return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(ke.ToolbarGroup,{className:"sensei-lms-question-block__grade-toolbar"},(0,s.createElement)(Je,{value:t,onChange:n})))},vt=function(e,t){return e.map((function(e){var n,r;return(null==st||null===(n=st[t])||void 0===n||null===(r=n.messages)||void 0===r?void 0:r[e])||zt.messages[e]}))},gt=g.__,ht=function(){return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(v.BlockControls,null,(0,s.createElement)(ke.Toolbar,null,(0,s.createElement)(ke.ToolbarButton,{disabled:!0},gt("Locked","sensei-lms")))),(0,s.createElement)(v.InspectorControls,null,(0,s.createElement)(ke.PanelBody,{title:gt("Question Details","sensei-lms"),initialOpen:!0},(0,s.createElement)("div",null,gt("You are not allowed to edit this question.","sensei-lms")))))};const bt=function(e){var t=e.clientId,n=e.attributes,r=n.title,l=n.answer,i=n.editable,a=e.questionIndex,c=e.questionGrade,u=e.AnswerBlock,m=(0,I.useSelect)((function(e){return e("core/block-editor").getBlock(t)}),[t]);return(0,s.createElement)("div",{className:"sensei-lms-question-block"},a,(0,s.createElement)("h2",{className:"sensei-lms-question-block__title"},r),c,(0,s.createElement)(s.RawHTML,null,(0,o.getBlockContent)(m)),(null==u?void 0:u.view)&&(0,s.createElement)(u.view,{attributes:l}),!i&&(0,s.createElement)(ht,null))};var Et=["controls","attributes","setAttributes"],_t=g.__;const wt=function(e){var t=e.controls,n=void 0===t?[]:t,o=e.attributes.options,l=void 0===o?{}:o,i=e.setAttributes,a=r(e,Et),c=function(e){return i({options:f(f({},l),e)})};return(0,s.createElement)(v.InspectorControls,null,(0,s.createElement)(ke.PanelBody,{title:_t("Question settings","sensei-lms"),initialOpen:!0},[$e].concat(ce(n)).map((function(e){return(0,s.createElement)(e,P({key:e},a,{options:l,setOptions:c}))}))))};var kt=["options","optionsLabel","icon","value","onChange","toggleProps","getMenuItemProps","popoverProps"];const yt=function(e){var t=e.options,n=e.optionsLabel,o=e.icon,l=e.value,i=e.onChange,a=e.toggleProps,c=e.getMenuItemProps,u=e.popoverProps,m=r(e,kt),d=t.find((function(e){return l===e.value}));return(0,s.createElement)(ke.Dropdown,P({className:"sensei-toolbar-dropdown",popoverProps:f(f({isAlternate:!0,position:"bottom right left",focusOnMount:!0},u),{},{className:b()(null==u?void 0:u.className,"sensei-toolbar-dropdown__popover")}),renderToggle:function(e){var t=e.isOpen,n=e.onToggle;return(0,s.createElement)(ke.Button,P({onClick:n,icon:o,"aria-expanded":t,"aria-haspopup":"true"},a,{children:null!=a&&a.children?a.children(d):null==d?void 0:d.label}))},renderContent:function(e){var r=e.onClose;return(0,s.createElement)(ke.NavigableMenu,{role:"menu",stopNavigationEvents:!0},(0,s.createElement)(ke.MenuGroup,{label:n},t.map((function(e){var t=e.value===(null==d?void 0:d.value),n=null==c?void 0:c(e);return(0,s.createElement)(ke.MenuItem,P({key:e.value,role:"menuitemradio",isSelected:t,icon:t?Be:null,className:b()("sensei-toolbar-dropdown__option",{"is-selected":t},null==n?void 0:n.className),onClick:function(){i(e.value),r()},children:e.label},n))}))))}},m))};var qt=g.__,Ct=Object.entries(st).map((function(e){var t=R(e,2),n=t[0],r=t[1];return f(f({},r),{},{label:r.title,value:n})}));Ct=(0,Ee.applyFilters)("senseiQuestionTypeToolbarOptions",Ct);var St=function(e){var t=e.value,n=e.onSelect;return(0,s.createElement)(ke.Toolbar,{className:"sensei-lms-question-block__type-selector__toolbar"},(0,s.createElement)(yt,{className:"sensei-lms-question-block__type-selector",label:qt("Question Type","sensei-lms"),options:Ct,value:t,onChange:function(e){return n(e)},optionsLabel:qt("Question Type","sensei-lms"),popoverProps:{className:"sensei-lms-question-block__type-selector__popover"},toggleProps:{children:function(e){return(0,s.createElement)("b",null,null==e?void 0:e.title)}},getMenuItemProps:function(e){var t=(0,s.createElement)("div",null,(0,s.createElement)("strong",null," ",e.title),(0,s.createElement)("div",{className:"sensei-lms-question-block__type-selector__option__description"},e.description));t=(0,Ee.applyFilters)("senseiQuestionTypeToolbarOptionChildren",t,e);var n={};return n.children=t,e.disabled&&(n.onClick=function(){}),n}}))};const Nt=window.wp.editPost;var xt=g.__;const Bt=function(e){var t=e.meta,n=t.validationErrors,r=t.showValidationErrors,o=e.setMeta,l=(0,s.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o({showValidationErrors:e})}),[o]);if(be((function(){return l(!1)}),[l]),null==n||!n.length)return null;var i=(0,s.createElement)(ke.Notice,{isDismissible:!1,status:"warning",className:"sensei-lms-quiz-block__pre-publish-validation__notice",actions:r?[]:[{label:xt("View issues","sensei-lms"),onClick:function(){return l(!0)},className:"is-link"}]},xt("This question is incomplete.","sensei-lms"));return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(Nt.PluginPostStatusInfo,null,i),(0,s.createElement)(Nt.PluginPrePublishPanel,{title:xt("Validation","sensei-lms"),initialOpen:!0},(0,s.createElement)(he,{onMount:l}),i,(0,s.createElement)("p",null,xt("Incomplete questions added to a quiz won't be displayed to the student.","sensei-lms"))))};var Pt=g.__,At=g._n;const Ot=(0,B.compose)(L,ue((function(e){var t,n=e.id,r=e.type,s=e.title,o=e.answer,l=r&&st[r],i=(null===(t=l.validate)||void 0===t?void 0:t.call(l,o))||{},a=null==s?void 0:s.length;return!a&&!o&&!n?{}:f({noTitle:!a},i)})))((function(e){var t,n,r=e.attributes,o=r.title,l=r.type,i=r.answer,a=void 0===i?{}:i,c=r.options,u=r.shared,m=r.editable,d=void 0===m||m,p=e.setAttributes,h=e.clientId,E=e.context,_=(0,I.useDispatch)("core/block-editor"),w=_.removeBlock,k=_.selectBlock,y=(0,s.useCallback)((function(){var e=(0,I.select)("core/block-editor").getBlocks(h);e.length&&k(e[0].clientId)}),[h,k]),q=de(h),C=l&&st[l],S=null==C?void 0:C.feedback,B=function(e){var t=e.isSelected,n=e.clientId;return(0,I.useSelect)((function(e){return e("core/block-editor").hasSelectedInnerBlock(n,!0)}),[n])||t}(e),A=E&&!("sensei-lms/quizId"in E),O=o||B||A,T=!A&&(0,s.createElement)("h2",{className:"sensei-lms-question-block__index"},q,"."),z=e.meta.showValidationErrors&&(null===(t=e.meta.validationErrors)||void 0===t?void 0:t.length),M=(0,s.createElement)("div",{className:"sensei-lms-question-block__grade"},(n=c.grade,(0,g.sprintf)(At("%d point","%d points",n,"sensei-lms"),n))),F=R((0,s.useState)(!1),2),j=F[0],Q=F[1],V=(0,s.useMemo)((function(){return{answer:a,setAttributes:p,AnswerBlock:C,hasSelected:B,canHaveFeedback:S,answerFeedback:{showAnswerFeedback:j,toggleAnswerFeedback:Q}}}),[C,a,B,p,j,S]),D=(0,s.useMemo)((function(){return[[Z.name,{}],[ae.name,{}]].concat(ce(S?[[N.name,{}],[x.name,{}]]:[]))}),[S]);return d?(0,s.createElement)("div",{className:b()("sensei-lms-question-block",{"is-draft":!o,"is-invalid":z,"show-answer-feedback":j})},T,A&&(0,s.createElement)(Bt,e),(0,s.createElement)("h2",{className:"sensei-lms-question-block__title"},(0,s.createElement)(ge,{placeholder:Pt("Question Title","sensei-lms"),value:o,onChange:function(e){return p({title:e})},onEnter:y,onRemove:function(){return w(h)}})),C.subtitle&&(0,s.createElement)(C.subtitle,{isQuestionSelected:B}),O&&M,B&&u&&(0,s.createElement)(mt,null),O&&(0,s.createElement)(ne.Provider,{value:V},(0,s.createElement)(v.InnerBlocks,{template:D,templateInsertUpdatesSelection:!1,templateLock:"all",renderAppender:null})),(0,s.createElement)(dt,P({},e,{getErrorMessages:vt})),(0,s.createElement)(v.BlockControls,null,(0,s.createElement)(s.Fragment,null,(0,s.createElement)(St,{value:l,onSelect:function(e){return p({type:e})}}),(0,s.createElement)(ft,{value:c.grade,onChange:function(e){return p({options:f(f({},c),{},{grade:e})})}}))),(0,s.createElement)(wt,P({controls:null==C?void 0:C.settings},e))):(0,s.createElement)(bt,P({},e,{questionGrade:M,questionIndex:T,AnswerBlock:C}))})),Rt=JSON.parse('{"name":"sensei-lms/quiz-question","parent":["sensei-lms/quiz"],"category":"sensei-lms","supports":{"html":false},"attributes":{"id":{"type":"integer"},"title":{"type":"string"},"type":{"type":"string","default":"multiple-choice"},"answer":{"type":"object"},"options":{"type":"object","default":{"grade":1}},"editable":{"type":"boolean","default":true,"source":false}}}');const It=[{onProgrammaticCreation:!0,isEligible:function(e,t){var n,r=!0;return null!==(n=e.options)&&void 0!==n&&n.answerFeedback&&(r=!0),t.map((function(e){return[Z.name,N.name,x.name].includes(e.name)&&(r=!1),!0})),r},attributes:f({},Rt.attributes),migrate:function(e,t){var n,r=[];return r.push((0,o.createBlock)(Z.name,{},t),(0,o.createBlock)(ae.name,{})),null!==(n=e.options)&&void 0!==n&&n.answerFeedback&&(r.push((0,o.createBlock)(N.name,{},[(0,o.createBlock)("core/paragraph",{content:e.options.answerFeedback})])),r.push((0,o.createBlock)(x.name,{},[(0,o.createBlock)("core/paragraph",{content:e.options.answerFeedback})]))),[f(f({},e),{},{options:(0,T.omit)(e.options,"answerFeedback")}),r]},save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)}},{onProgrammaticCreation:!0,isEligible:function(e){var t;return e.media||"file-upload"===e.type&&!(null===(t=e.options)||void 0===t||!t.studentHelp)},attributes:f(f({},Rt.attributes),{},{media:{type:"object"}}),migrate:function(e,t){var n,r=ce(t);return e.media&&r.push(function(e){switch(e.type){case"image":return(0,o.createBlock)("core/image",{id:e.id,url:e.url});case"audio":return(0,o.createBlock)("core/audio",{id:e.id,src:e.url});case"video":return(0,o.createBlock)("core/video",{id:e.id,src:e.url});default:var t=(0,s.createElement)("a",{href:e.url},e.title);return(0,o.createBlock)("core/paragraph",{content:(0,s.renderToString)(t)})}}(e.media)),"file-upload"===e.type&&null!==(n=e.options)&&void 0!==n&&n.studentHelp&&r.push((0,o.createBlock)("core/paragraph",{content:e.options.studentHelp})),[f(f({},(0,T.omit)(e,"media")),{},{options:(0,T.omit)(e.options,"studentHelp")}),r]},save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)}}];var Tt=g.__;const zt=f(f({},Rt),{},{title:Tt("Question","sensei-lms"),icon:q,usesContext:["sensei-lms/quizId"],description:Tt("The building block of all quizzes.","sensei-lms"),example:{attributes:{title:Tt("Example Quiz Question","sensei-lms")}},deprecated:It,edit:Ot,save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)},messages:{noTitle:Tt("Add a title to this question.","sensei-lms")}});var Mt=function(){var e=(0,I.useSelect)((function(e){var t=e("core").getEntityRecords("taxonomy","question-category",{per_page:-1});return null!=t?t:[]}),[]),t=(0,s.useMemo)((function(){return(e||[]).map((function(e){return f(f({},e),{},{name:unescape(e.name)})}))}),[e]),n=(0,s.useMemo)((function(){return(0,T.keyBy)(null!=t?t:[],"id")}),[t]);return[t,function(e){var t;return!(!n||0===n.length)&&(null!==(t=n[e])&&void 0!==t&&t)}]};const Ft=window.wp.apiFetch;var jt=n.n(Ft),Qt=g.__,Vt=g._n;const Dt=function(e){var t,n,r,o,l,i,a,c=e.attributes.options,u=void 0===c?{}:c,m=e.setAttributes,d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m(f(f({},t),{},{options:f(f({},u),e)}))},p=R(Mt(),2),h=p[0],b=p[1],E=R((0,s.useState)(null),2),_=E[0],w=E[1],k=(r=u.category,o=w,l=R((0,s.useState)({}),2),i=l[0],a=l[1],(0,s.useEffect)((function(){r&&!i.hasOwnProperty(r)&&jt()({path:"/wp/v2/questions?question-category=".concat(r),method:"GET",parse:!1}).then((function(e){i[r]=+e.headers.get("X-WP-Total"),a(f({},i))})).catch((function(e){e.json().then((function(e){return o(e.message)}))}))}),[r,i,o]),!!i.hasOwnProperty(r)&&i[r]),y=[{value:"",label:""}].concat(ce((h||[]).map((function(e){return{value:e.id,label:e.name}}))));return(0,s.createElement)(v.InspectorControls,null,(0,s.createElement)(ke.PanelBody,{title:Qt("Category Question Settings","sensei-lms"),initialOpen:!0},!y.length&&(0,s.createElement)(ke.Notice,{status:"warning",isDismissible:!1},Qt("No question categories exist.","sensei-lms")),y.length>0&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)(ke.SelectControl,{label:Qt("Category","sensei-lms"),options:y,value:null!==(t=u.category)&&void 0!==t?t:"",onChange:function(e){var t,n=b(+e);d({category:null!==(t=+e)&&void 0!==t?t:null},{categoryName:null==n?void 0:n.name}),w(null)}}),(0,s.createElement)(Ke,{label:Qt("Number of Questions","sensei-lms"),min:1,step:1,value:null!==(n=u.number)&&void 0!==n?n:1,onChange:function(e){return e&&d({number:e||1})}}),null!==_&&(0,s.createElement)(ke.Notice,{status:"error",isDismissible:!1},(0,g.sprintf)(Qt("An error occurred while retrieving questions: %s","sensei-lms"),_)),!1!==k&&null===_&&u.number>k&&(0,s.createElement)(ke.Notice,{status:"warning",isDismissible:!1},(0,g.sprintf)(Vt("The selected category has %d question.","The selected category has %d questions.",k,"sensei-lms"),k)))))};var Lt=function(e){return e.map((function(e){return Kt.messages[e]}))},Ut=g.__,Gt=g._n;const Ht=(0,B.compose)(L,ue((function(e){var t=e.options;return{noCategory:!((null==t?void 0:t.category)>0)}})))((function(e){var t,n,r=e.attributes.options,o=r.number,l=void 0===o?1:o,i=r.category,a=e.clientId,c=e.setAttributes,u=de(a),m=R(Mt(),2)[1],d=l&&1!==l?"".concat(u," - ").concat(u+l-1):u,p=(0,s.createElement)("h2",{className:"sensei-lms-question-block__index"},d,"."),f=null!==(t=null===(n=m(i))||void 0===n?void 0:n.name)&&void 0!==t?t:e.attributes.categoryName,v=f===e.attributes.categoryName;return(0,s.useEffect)((function(){f&&!v&&c({categoryName:f})}),[f,v,c]),(0,s.createElement)(s.Fragment,null,(0,s.createElement)(Dt,e),(0,s.createElement)("div",{className:"sensei-lms-question-block sensei-lms-category-question-block ".concat(i?"":"is-draft")},p,(0,s.createElement)("h2",{className:"sensei-lms-question-block__title"},f?(0,s.createElement)("strong",null,f):Ut("Category Question","sensei-lms"),f&&l>0&&" ("+(0,g.sprintf)(Gt("%d question","%d questions",l,"sensei-lms"),l)+")")),(0,s.createElement)(dt,P({},e,{getErrorMessages:Lt})))})),Wt=JSON.parse('{"name":"sensei-lms/quiz-category-question","parent":["sensei-lms/quiz"],"category":"sensei-lms","supports":{"html":false},"attributes":{"id":{"type":"integer"},"type":{"type":"string","default":"category-question"},"categoryName":{"type":"string"},"options":{"type":"object","default":{"category":null,"number":1}}}}');var Zt=g.__;const Kt=f(f({},Wt),{},{title:Zt("Category Question","sensei-lms"),icon:q,usesContext:["sensei-lms/quizId"],description:Zt("Pull questions from a question category.","sensei-lms"),example:{attributes:{categoryName:Zt("Example Category","sensei-lms")}},edit:Ht,save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)},messages:{noCategory:Zt("Assign a category to this question.","sensei-lms")}});var Jt,Yt,$t;function Xt(){return Xt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xt.apply(this,arguments)}const en=function(e){return l.createElement("svg",Xt({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Jt||(Jt=l.createElement("path",{fill:"transparent",stroke:"currentColor",strokeWidth:1.5,d:"M21 8v11c0 1.105-.894 2-1.999 2H6"})),Yt||(Yt=l.createElement("rect",{x:3.75,y:3.75,width:13.5,height:13.5,rx:.875,stroke:"currentColor",strokeWidth:1.5,fill:"transparent"})),$t||($t=l.createElement("path",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd",d:"M12 9a1.5 1.5 0 0 0-3 0H7.5a3 3 0 1 1 3.75 2.905v.845h-1.5V11.5c0-.57.452-.958.917-1.01A1.5 1.5 0 0 0 12 9Zm-2.25 4.75v1.5h1.5v-1.5h-1.5Z"})))};const tn=window.wp.dataControls,nn=window.wp.url;var rn;jt().use((rn={},function(e,t){return"string"!=typeof e.path||"GET"!==e.method&&e.method||(rn[e.path]?e.path=(0,nn.addQueryArgs)(e.path,{__skip_preload:1}):rn[e.path]=!0),t(e)}));var sn=["storeName","getEndpoint","saveError","fetchError","clearError","updateBlock","readBlock","setServerStructure"];var on=["description"];function ln(e,t){return e&&0!==e.length?(e||[]).map((function(e){var n=e.description,s=r(e,on),l=t?cn(t,e):null;if(l){l.attributes=f(f({},l.attributes),s);var i=n&&(0,o.rawHandler)({HTML:n})||[];(0,I.dispatch)("core/block-editor").replaceInnerBlocks(l.clientId,i)}else l=an(e);return l})):[(0,o.createBlock)("sensei-lms/quiz-question",{})]}function an(e){if("category-question"===e.type)return(0,o.createBlock)(Kt.name,e,[]);var t=function(e,t){return zt.deprecated.forEach((function(n){if(n.onProgrammaticCreation&&n.isEligible(e,t)){var r=R(n.migrate(e,t),2);e=r[0],t=r[1]}})),[e,t]}(e,e.description&&(0,o.rawHandler)({HTML:e.description})||[]),n=R(t,2),r=n[0],s=n[1];return(0,o.createBlock)(zt.name,r,s)}var cn=function(e,t){var n=t.id,r=t.title,s=t.options,o=null==s?void 0:s.category;return e.find((function(e){var t,s,l=e.attributes;return n===l.id||!l.id&&l.title&&l.title===r||!l.id&&(null===(t=l.options)||void 0===t?void 0:t.category)&&(null===(s=l.options)||void 0===s?void 0:s.category)===o}))},un=function e(t,n){var r=(0,T.mapKeys)(t,(function(e,t){return n(t)}));return(0,T.mapValues)(r,(function(t){return(0,T.isObject)(t)?e(t,n):t}))},mn=function(e){return"category-question"===e.type?!e.options.category:!e.title},dn=g.__,pn="sensei/quiz-structure",fn=["categories","shared","options.studentHelp","media","categoryName","lock"];!function(e){var t,n,s=e.storeName,o=e.getEndpoint,l=e.saveError,i=e.fetchError,a=e.clearError,c=e.updateBlock,u=e.readBlock,m=e.setServerStructure,d=r(e,sn),p={loadStructure:regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(o(),"t0",2);case 2:return t=e.t0,e.next=5,(0,tn.apiFetch)({path:"/sensei-internal/v1/".concat(t),method:"GET"});case 5:return n=e.sent,e.next=8,p.setResult(n);case 8:e.next=14;break;case 10:return e.prev=10,e.t1=e.catch(0),e.next=14,null==i?void 0:i(e.t1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})),saveStructure:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.select)(s).getEditorStructure();case 2:return t=e.sent,e.prev=3,e.delegateYield(o(),"t0",5);case 5:return n=e.t0,e.next=8,(0,tn.apiFetch)({path:"/sensei-internal/v1/".concat(n),method:"POST",data:t});case 8:return r=e.sent,e.next=11,p.setResult(r);case 11:e.next=17;break;case 13:return e.prev=13,e.t1=e.catch(3),e.next=17,null==l?void 0:l(e.t1);case 17:case"end":return e.stop()}}),e,null,[[3,13]])})),setResult:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.setServerStructure(t);case 2:return e.next=4,c(t);case 4:case"end":return e.stop()}}),e)})),setServerStructure:function(e){return{type:"SET_SERVER_STRUCTURE",serverStructure:e}},setEditorStructure:function(e){return{type:"SET_EDITOR_STRUCTURE",editorStructure:e}},savePost:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{type:"SAVE_POST"};case 2:return e.next=4,(0,I.dispatch)("core/editor").savePost();case 4:case"end":return e.stop()}}),e)})),startPostSave:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{type:"START_SAVE"};case 2:return t=u(),e.next=5,p.setEditorStructure(t);case 5:return e.next=7,null==a?void 0:a();case 7:if(t){e.next=9;break}return e.abrupt("return");case 9:if(!(0,I.select)(s).hasUnsavedEditorChanges()){e.next=11;break}return e.delegateYield(p.saveStructure(),"t0",11);case 11:return e.next=13,{type:"FINISH_SAVE"};case 13:case"end":return e.stop()}}),e)})),finishPostSave:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{type:"FINISH_POST_SAVE"};case 2:if(t=(0,I.select)(s),!(0,t.hasUnsavedServerUpdates)()){e.next=5;break}return e.delegateYield(p.savePost(),"t0",5);case 5:case"end":return e.stop()}}),e)})),setBlock:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,{type:"SET_BLOCK",clientId:t};case 2:case"end":return e.stop()}}),e)}))},v={SET_SERVER_STRUCTURE:function(e,t){var n=e.serverStructure,r=!t.editorStructure,s=m?m(n):n,o=!r&&!(0,T.isEqual)(s,t.editorStructure);return f(f({},t),{},{serverStructure:s,hasUnsavedServerUpdates:o,hasUnsavedEditorChanges:!1})},SET_EDITOR_STRUCTURE:function(e,t){var n=e.editorStructure,r=!(0,T.isEqual)(t.serverStructure,n);return f(f({},t),{},{editorStructure:n,hasUnsavedEditorChanges:r&&!!n})},START_SAVE:function(e,t){return f(f({},t),{},{isSavingStructure:!0})},FINISH_SAVE:function(e,t){return f(f({},t),{},{isSavingStructure:!1})},SAVE_POST:function(e,t){return f(f({},t),{},{hasUnsavedServerUpdates:!1})},SET_BLOCK:function(e,t){var n=e.clientId;return f(f({},t),{},{clientId:n})},DEFAULT:function(e,t){return t}};t=!1,n=!1,(0,I.subscribe)((function(){var e=(0,I.select)("core/editor");if(e){var r=e.isSavingPost()&&!e.isAutosavingPost(),o=(0,I.select)(s).getIsSavingStructure();r&&(n=!0),t||r||!n?t&&!o&&(t=!1,(0,I.dispatch)(s).finishPostSave()):(t=!0,n=!1,(0,I.dispatch)(s).startPostSave())}})),(0,I.registerStore)(s,{reducer:z(f(f({},v),null==d?void 0:d.reducers),{serverStructure:null,editorStructure:null,isSavingStructure:!1,hasUnsavedServerUpdates:!1,hasUnsavedEditorChanges:!1,clientId:null}),actions:f(f({},p),null==d?void 0:d.actions),selectors:f(f({},{hasUnsavedServerUpdates:function(e){return e.hasUnsavedServerUpdates},hasUnsavedEditorChanges:function(e){return e.hasUnsavedEditorChanges},getIsSavingStructure:function(e){return e.isSavingStructure},getServerStructure:function(e){return e.serverStructure},getEditorStructure:function(e){return e.editorStructure},getBlock:function(e){return e.clientId}}),null==d?void 0:d.selectors),controls:f(f({},tn.controls),null==d?void 0:d.controls)})}({storeName:pn,getEndpoint:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.select)("core/editor").getCurrentPostId();case 2:return t=e.sent,e.abrupt("return","lesson-quiz/".concat(t,"?context=edit"));case 4:case"end":return e.stop()}}),e)})),updateBlock:regeneratorRuntime.mark((function e(t){var n,r,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,I.select)(pn).getBlock();case 2:if((r=e.sent)&&t){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,(0,I.select)("core/block-editor").getBlock(r);case 7:if(e.sent){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,(0,I.dispatch)("core/block-editor").updateBlockAttributes(r,{options:un(t.options,T.camelCase)});case 12:if(null!==(n=t.questions)&&void 0!==n&&n.length){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,(0,I.select)("core/block-editor").getBlocks(r);case 16:return s=e.sent,e.next=19,(0,I.dispatch)("core/block-editor").replaceInnerBlocks(r,ln(t.questions,s),!1);case 19:case"end":return e.stop()}}),e)})),readBlock:function(){var e=(0,I.select)(pn).getBlock();if(e){var t=(0,I.select)("core/block-editor").getBlock(e);if(t){var n=un(t.attributes.options,T.snakeCase),r=function(e){var t=null==e?void 0:e.map((function(e){var t=(0,T.omit)(e.attributes,["className"]);return"category-question"===e.attributes.type?t:f(f({},t),{},{description:(0,o.getBlockContent)(e)})})),n=t.pop();return mn(n)||t.push(n),t}((0,I.select)("core/block-editor").getBlocks(e)),s=(0,T.keyBy)((0,I.select)(pn).getServerStructure().questions,"id"),l=(0,I.select)("core/editor").getCurrentPost();return{lesson_status:null==l?void 0:l.status,lesson_title:null==l?void 0:l.title,options:n,questions:r.map((function(e){return!1===e.editable?s[e.id]:(0,T.omit)(e,fn)}))}}}},fetchError:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,g.sprintf)(dn("Quiz settings and questions could not be loaded. %s","sensei-lms"),t.message),e.next=3,(0,I.dispatch)("core/notices").createErrorNotice(n,{id:"quiz-structure-save-error"});case 3:case"end":return e.stop()}}),e)})),saveError:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,g.sprintf)(dn("Quiz settings and questions could not be updated. %s","sensei-lms"),t.message),e.next=3,(0,I.dispatch)("core/notices").createErrorNotice(n,{id:"quiz-structure-save-error"});case 3:case"end":return e.stop()}}),e)})),clearError:function(){(0,I.dispatch)("core/notices").removeNotice("quiz-structure-save-error")},setServerStructure:function(e){return e?f(f({},e),{},{questions:e.questions.map((function(e){return(0,T.omit)(e,fn)}))}):{}}});var vn=g.__,gn=g._n,hn=function(e){var t=e.count,n=e.onClick;return(0,s.createElement)("div",null,(0,s.createElement)(ke.Notice,{isDismissible:!1,status:"warning",className:"sensei-lms-quiz-block__pre-publish-validation__notice",actions:[{label:vn("View issues","sensei-lms"),onClick:n,className:"is-link"}]},(0,g.sprintf)(gn("There is %d incomplete question in this lesson's quiz.","There are %d incomplete questions in this lesson's quiz.",t,"sensei-lms"),t)))};const bn=function(e){var t=e.clientId,n=e.setMeta,r=(0,I.useSelect)((function(e){var n=e("core/block-editor").getBlocks(t),r=e(F).getMultipleBlockMeta(n.map((function(e){return e.clientId})),"validationErrors");return n.map((function(e){return f(f({},e),{},{errors:r[e.clientId]})})).filter((function(e){var t;return null===(t=e.errors)||void 0===t?void 0:t.length}))}),[t]),o=(0,s.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n({showValidationErrors:e})}),[n]),l=(0,I.useDispatch)("core/block-editor").selectBlock;if(be((function(){return o(!1)}),[o]),!r.length)return null;var i=(0,s.createElement)(hn,{onClick:function(){r.length&&(o(!0),l(r[0].clientId))},count:r.length});return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(Nt.PluginPostStatusInfo,null,i),(0,s.createElement)(Nt.PluginPrePublishPanel,{title:vn("Lesson Quiz","sensei-lms"),initialOpen:!0},(0,s.createElement)(he,{onMount:o}),i,(0,s.createElement)("p",null,vn("Incomplete questions won't be displayed to the student when taking the quiz.","sensei-lms"))))};var En=function(e){var t=(0,I.useSelect)((function(t){return t("core/block-editor").getBlocks(e)}),[]),n=t.length&&t[t.length-1];return n&&mn(n.attributes)?t.length-1:t.length};const wn=(0,s.createElement)(X.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(X.Path,{d:"M18 11.2h-5.2V6h-1.6v5.2H6v1.6h5.2V18h1.6v-5.2H18z"}));const kn=function(e){var t=e.controls,n=e.text,r=e.label;return(0,s.createElement)("div",{className:"sensei-lms-text-appender block-editor-default-block-appender"},(0,s.createElement)(ke.DropdownMenu,{icon:wn,toggleProps:{className:"block-editor-inserter__toggle",onMouseDown:function(e){return e.preventDefault()}},label:r,controls:t,popoverProps:{position:"bottom center"},menuProps:{className:"sensei-lms-text-appender__menu"}}),(0,s.createElement)("p",{className:"sensei-lms-text-appender__placeholder","data-placeholder":n}))};var yn=g.__;const qn=function(e){var t=e.clientId,n=e.openModal,r=(0,I.useDispatch)("core/block-editor").insertBlock,l=En(t),i=function(e){r((0,o.createBlock)(e.name),l,t,!0)},a=[{title:yn("New Question","sensei-lms"),icon:zt.icon,onClick:function(){return i(zt)}},{title:yn("Category Question(s)","sensei-lms"),icon:en,onClick:function(){return i(Kt)}},{title:yn("Existing Question(s)","sensei-lms"),icon:en,onClick:n}],c=yn("Add new or existing question(s)","sensei-lms");return(0,s.createElement)(kn,{controls:a,text:c,label:c})};const Cn=(0,s.createElement)(X.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,s.createElement)(X.Path,{d:"M13.5 6C10.5 6 8 8.5 8 11.5c0 1.1.3 2.1.9 3l-3.4 3 1 1.1 3.4-2.9c1 .9 2.2 1.4 3.6 1.4 3 0 5.5-2.5 5.5-5.5C19 8.5 16.5 6 13.5 6zm0 9.5c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z"}));var Sn=["className","id","label","value","help","iconRight","onChange"];const Nn=function(e){var t=e.className,n=e.id,o=e.label,l=e.value,i=e.help,a=e.iconRight,c=e.onChange,u=r(e,Sn);return(0,s.createElement)(ke.BaseControl,{id:n,label:o,help:i},(0,s.createElement)("div",{className:"sensei-input-control"},(0,s.createElement)("input",P({className:b()("sensei-input-control__input",{"sensei-input-control__input--with-icon-right":a},t),type:"text",id:n,value:null===l?"":l,onChange:function(e){return c(e.target.value)}},u)),a&&(0,s.createElement)("span",{className:"sensei-input-control__icon"},(0,s.createElement)(ke.Icon,{icon:a}))))};var xn=g.__;const Bn=function(e){var t=e.questionCategories,n=e.filters,r=e.setFilters,o=(0,s.useState)(n.search).searchValue,l=function(){var e=R((0,s.useState)([]),2),t=e[0],n=e[1];return(0,s.useEffect)((function(){jt()({path:"/wp/v2/question-type?per_page=-1"}).then(n)}),[n]),t}(),i=function(e,t){return(0,T.debounce)((function(t){r((function(n){return f(f({},n),{},d({},e,t))}))}),t)},a=[{value:"",label:xn("Type","sensei-lms")}].concat(ce((l||[]).map((function(e){var t;return{value:e.id,label:null===(t=st[e.slug])||void 0===t?void 0:t.title}})))),c=[{value:"",label:xn("Category","sensei-lms")}].concat(ce((t||[]).map((function(e){return{value:e.id,label:e.name}}))));return(0,s.createElement)("ul",{className:"sensei-lms-quiz-block__questions-modal__filters"},(0,s.createElement)("li",null,(0,s.createElement)(ke.SelectControl,{options:a,value:n["question-type"],onChange:i("question-type",0)})),(0,s.createElement)("li",null,(0,s.createElement)(ke.SelectControl,{options:c,value:n["question-category"],onChange:i("question-category",0)})),(0,s.createElement)("li",null,(0,s.createElement)(Nn,{className:"sensei-lms-quiz-block__questions-modal__search-input",placeholder:xn("Search questions","sensei-lms"),iconRight:Cn,value:o,onChange:i("search",400)})))};var Pn=g.__;const An=function(e){var t=e.clientId,n=e.questionCategories,r=e.filters,o=e.selectedQuestionIds,l=e.setSelectedQuestionIds,i=(0,I.useSelect)((function(e){return e("core/block-editor").getBlocks(t)})).map((function(e){var t;return null===(t=e.attributes)||void 0===t?void 0:t.id})),a=(0,I.useSelect)((function(e){return e("core").getEntityRecords("postType","question",f({per_page:100},(0,T.omitBy)(r,(function(e){return""===e}))))}),[r]);if(!a||!n)return(0,s.createElement)("div",{className:"sensei-lms-quiz-block__questions-modal__questions sensei-lms-quiz-block__questions-modal__questions--loading"},(0,s.createElement)(ke.Spinner,null));a=a.filter((function(e){return!i.includes(e.id)}));var c=(0,T.keyBy)(n,"id"),u=a.length>0&&a.every((function(e){return o.includes(e.id)})),m=function(e){return function(t){l(t?function(t){return[].concat(ce(t),[e])}:function(t){return t.filter((function(t){return t!==e}))})}};return(0,s.createElement)("div",{className:"sensei-lms-quiz-block__questions-modal__questions"},(0,s.createElement)("table",{className:"sensei-lms-quiz-block__questions-modal__table"},(0,s.createElement)("thead",null,(0,s.createElement)("tr",null,(0,s.createElement)("th",{className:"sensei-lms-quiz-block__questions-modal__question-checkbox"},(0,s.createElement)(ke.CheckboxControl,{title:Pn("Toggle all visible questions selection.","sensei-lms"),checked:u,onChange:function(e){var t=a.map((function(e){return e.id}));l((function(n){return e?(0,T.uniq)([].concat(ce(n),ce(t))):n.filter((function(e){return!t.includes(e)}))}))}})),(0,s.createElement)("th",null,Pn("Question","sensei-lms")),(0,s.createElement)("th",null,Pn("Type","sensei-lms")),(0,s.createElement)("th",null,Pn("Category","sensei-lms")))),(0,s.createElement)("tbody",null,0===a.length?(0,s.createElement)("tr",null,(0,s.createElement)("td",{colSpan:"4"},(0,s.createElement)("p",null,Pn("No questions found.","sensei-lms")))):a.map((function(e){var t,n=null===(t=st[e["question-type-slug"]])||void 0===t?void 0:t.title,r=e["question-category"].map((function(e){var t;return null===(t=c[e])||void 0===t?void 0:t.name})).join(", "),l=e.id,i=e.title.raw;return(0,s.createElement)("tr",{key:e.id},(0,s.createElement)("td",null,(0,s.createElement)(ke.CheckboxControl,{id:"question-".concat(l),title:i,checked:o.includes(l),onChange:m(l)})),(0,s.createElement)("td",{className:"sensei-lms-quiz-block__questions-modal__question-title"},(0,s.createElement)("label",{htmlFor:"question-".concat(l),title:i},i)),(0,s.createElement)("td",null,n),(0,s.createElement)("td",null,r))})))))};var On=g.__;const Rn=function(e){var t=e.selectedQuestionIds,n=e.setSelectedQuestionIds,r=e.onAdd,o=e.closeModal,l=e.setErrorAddingSelected,i=R((0,s.useState)(!1),2),a=i[0],c=i[1],u=0===t.length?On("Add Selected","sensei-lms"):(0,g.sprintf)(On("Add Selected (%s)","sensei-lms"),t.length);return(0,s.createElement)("ul",{className:"sensei-lms-quiz-block__questions-modal__actions"},t.length>0&&(0,s.createElement)("li",null,(0,s.createElement)(ke.Button,{isTertiary:!0,onClick:function(){n([])}},On("Clear Selected","sensei-lms"))),(0,s.createElement)("li",null,(0,s.createElement)(ke.Button,{disabled:a,onClick:function(){c(!0),r(t).then(o).catch((function(){l(!0),c(!1)}))},isPrimary:!0},u)))};var In=g.__;const Tn=function(e){var t=e.clientId,n=e.onClose,r=function(e){var t=(0,I.select)("core/block-editor").getBlocks(e),n=(0,I.useDispatch)("core/block-editor").insertBlock,r=En(e);return function(s){var o=s.filter((function(e){return 0===t.length||!cn(t,{id:e})}));if(0===o.length)return Promise.resolve({});var l=r;return jt()({path:"/sensei-internal/v1/question-options?question_ids="+o.join(","),method:"GET"}).then((function(t){Array.isArray(t)&&t.length>0&&t.forEach((function(t){n(an(t),l,e,!1),l++}))}))}}(t),o=R((0,s.useState)({search:"","question-type":"","question-category":""}),2),l=o[0],i=o[1],a=R((0,s.useState)(!1),2),c=a[0],u=a[1],m=R((0,s.useState)([]),2),d=m[0],p=m[1],f=R(Mt(),1)[0];return(0,s.createElement)(ke.Modal,{className:"sensei-lms-quiz-block__questions-modal",title:In("Questions","sensei-lms"),onRequestClose:n},c&&(0,s.createElement)(ke.Notice,{status:"error",isDismissible:!1,className:"sensei-lms-quiz-block__questions-modal__notice"},In("Unable to add the selected question(s). Please make sure you are still logged in and try again.","sensei-lms")),(0,s.createElement)(Bn,{questionCategories:f,filters:l,setFilters:i}),(0,s.createElement)(An,{clientId:t,questionCategories:f,filters:l,selectedQuestionIds:d,setSelectedQuestionIds:p}),(0,s.createElement)(Rn,{selectedQuestionIds:d,setSelectedQuestionIds:p,onAdd:r,closeModal:n,setErrorAddingSelected:u}))};var zn=["settings","updatePagination"],Mn=g.__,Fn=g._n,jn="single",Qn="multi",Vn=[{label:Mn("Single page","sensei-lms"),value:jn},{label:Mn("Multi-page","sensei-lms"),value:Qn}],Dn=function(e){return function(t){e({paginationNumber:t===Qn?1:null})}},Ln=function(e){var t=e.settings,n=e.updatePagination,o=r(e,zn),l=t.paginationNumber;return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(Ke,P({label:Mn("Number of Questions","sensei-lms"),min:1,step:1,hideLabelFromVision:!0,suffix:Fn("question","questions",l,"sensei-lms"),value:l,onChange:function(e){return n({paginationNumber:e})}},o)),(0,s.createElement)("span",null,Mn("per page","sensei-lms")))},Un=function(e){var t=e.settings,n=e.updatePagination,r=t.paginationNumber,o=t.showProgressBar,l=t.progressBarRadius,i=t.progressBarHeight;return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(ke.PanelBody,{title:Mn("Pagination","sensei-lms"),initialOpen:!0},(0,s.createElement)(ke.PanelRow,{className:"sensei-lms-quiz-block-settings__pagination"},(0,s.createElement)(ke.SelectControl,{label:Mn("Pagination","sensei-lms"),hideLabelFromVision:!0,value:null===r?jn:Qn,options:Vn,onChange:Dn(n)})),null!==r&&(0,s.createElement)(ke.PanelRow,{className:"sensei-lms-quiz-block-settings__question-count"},(0,s.createElement)(Ln,{settings:t,updatePagination:n})),null!==r&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(ke.ToggleControl,{checked:o,label:Mn("Show Progress Bar","sensei-lms"),value:l,onChange:function(e){return n({showProgressBar:e})}})),(0,s.createElement)(ke.PanelRow,{className:"sensei-lms-quiz-block-settings__progress-bar"},(0,s.createElement)(Ke,{label:Mn("Radius","sensei-lms"),min:1,step:1,suffix:Mn("PX","sensei-lms"),value:l,onChange:function(e){return n({progressBarRadius:e})}}),(0,s.createElement)(Ke,{label:Mn("Height","sensei-lms"),min:1,step:1,suffix:Mn("PX","sensei-lms"),value:i,onChange:function(e){return n({progressBarHeight:e})}})))))},Gn=function(e){var t=e.settings,n=e.updatePagination,r=t.paginationNumber;return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(ke.Toolbar,null,(0,s.createElement)(yt,{options:Vn,optionsLabel:Mn("Quiz pagination","sensei-lms"),value:null===r?jn:Qn,onChange:Dn(n)})),null!==r&&(0,s.createElement)(ke.ToolbarGroup,{className:"sensei-lms-quiz-block__toolbar-group"},(0,s.createElement)(Ln,{settings:t,updatePagination:n})))},Hn=g.__;const Wn=function(){return(0,s.createElement)("div",{className:"sensei-lms-quiz-block-settings__quiz-timer-promo"},(0,s.createElement)(ke.ToggleControl,{disabled:!0,label:Hn("Quiz Timer","sensei-lms"),help:Hn("The quiz timer enables you to control how much time a student has to complete the quiz.","sensei-lms")}),(0,s.createElement)("p",null,(0,s.createElement)(ke.ExternalLink,{href:"https://senseilms.com/pricing/?utm_source=plugin_sensei&utm_medium=upsell&utm_campaign=quiz_timer"},Hn("Upgrade to Sensei Pro","sensei-lms"))))};var Zn,Kn;function Jn(){return Jn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jn.apply(this,arguments)}const Yn=function(e){return l.createElement("svg",Jn({width:24,height:24,xmlns:"http://www.w3.org/2000/svg"},e),Zn||(Zn=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.929 18.5a6 6 0 1 0 0-12 6 6 0 0 0 0 12Zm0-3a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",fill:"currentColor"})),Kn||(Kn=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.276 4.5a1 1 0 0 0-.987.836L9.93 7.5h4l-.361-2.164a1 1 0 0 0-.986-.836h-1.306Zm1.306 16a1 1 0 0 0 .986-.836l.36-2.164h-4l.361 2.164a1 1 0 0 0 .987.836h1.306ZM18.53 7.934a1 1 0 0 0-1.217-.436l-2.055.77 2 3.464 1.694-1.395a1 1 0 0 0 .23-1.272l-.652-1.13ZM5.326 17.065a1 1 0 0 0 1.217.436l2.055-.77-2-3.463-1.694 1.394a1 1 0 0 0-.23 1.272l.652 1.131ZM4.675 9.066a1 1 0 0 0 .23 1.272l1.694 1.394 2-3.464-2.055-.77a1 1 0 0 0-1.217.437l-.652 1.13Zm14.509 6.869a1 1 0 0 0-.23-1.272l-1.695-1.395-2 3.464 2.055.77a1 1 0 0 0 1.217-.436l.653-1.131Z",fill:"currentColor"})))};var $n=g.__;const Xn=function(e){var t=e.attributes.options,n=e.setAttributes,r=e.clientId,o=t.passRequired,l=t.quizPassmark,i=t.autoGrade,a=t.allowRetakes,c=t.randomQuestionOrder,u=t.showQuestions,m=t.failedShowAnswerFeedback,p=t.failedShowCorrectAnswers,g=t.failedIndicateIncorrect,h=t.buttonTextColor,b=t.buttonBackgroundColor,E=t.pagination,_=function(e){return function(r){return n({options:f(f({},t),{},d({},e,r))})}},w=function(e){return n({options:f(f({},t),{},{pagination:f(f({},E),e)})})},k=function(e){var t=(0,I.useDispatch)("core/edit-post").openGeneralSidebar,n=(0,I.useDispatch)("core/block-editor").selectBlock;return function(){n(e),t("edit-post/block")}}(r),y=(0,I.useSelect)((function(e){return e("core/block-editor").getBlock(r).innerBlocks.filter((function(e){return!mn(e.attributes)}))}),[r]).reduce((function(e,t){return e+("category-question"===t.attributes.type?t.attributes.options.number:1)}),0),q=(0,Ee.applyFilters)("senseiQuizTimerHide",!1);return(0,s.useEffect)((function(){u>y&&n({options:f(f({},t),{},{showQuestions:y})})}),[t,y,n,u]),(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"sensei-lms-quiz-block__settings-quick-nav"},(0,s.createElement)(ke.Button,{onClick:k,icon:Yn},$n("Quiz settings","sensei-lms"))),(0,s.createElement)(v.InspectorControls,null,(0,s.createElement)(ke.PanelBody,{title:$n("Quiz settings","sensei-lms"),initialOpen:!0},(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(ke.ToggleControl,{checked:o,onChange:_("passRequired"),label:$n("Pass Required","sensei-lms")})),o&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(ke.RangeControl,{label:$n("Passing Grade (%)","sensei-lms"),value:l,onChange:_("quizPassmark"),min:0,max:100,initialPosition:100})),(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)("div",null,(0,s.createElement)(ke.BaseControl,{id:"sensei-lms-quiz-block-failed-feedback-options",className:"sensei-lms-subsection-control",help:$n("What students see when reviewing their quiz after grading.","sensei-lms")},(0,s.createElement)("h3",null,$n("If student does not pass quiz","sensei-lms"))),(0,s.createElement)(ke.ToggleControl,{checked:g,onChange:_("failedIndicateIncorrect"),label:$n("Indicate which questions are incorrect.","sensei-lms")}),(0,s.createElement)(ke.ToggleControl,{checked:p,onChange:_("failedShowCorrectAnswers"),label:$n("Show correct answers.","sensei-lms")}),(0,s.createElement)(ke.ToggleControl,{checked:m,onChange:_("failedShowAnswerFeedback"),label:$n("Show “Answer Feedback” text.","sensei-lms")}))),(0,s.createElement)("hr",null)),(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(ke.ToggleControl,{checked:i,onChange:_("autoGrade"),label:$n("Auto Grade","sensei-lms"),help:$n("Automatically grade Multiple Choice, True/False and Gap Fill questions that have a non-zero point value.","sensei-lms")})),(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(ke.ToggleControl,{checked:a,onChange:_("allowRetakes"),label:$n("Allow Retakes","sensei-lms")})),(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(ke.ToggleControl,{checked:c,onChange:_("randomQuestionOrder"),label:$n("Random Question Order","sensei-lms")})),c&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(Ke,{id:"sensei-quiz-settings-show-questions",label:$n("Number of Questions","sensei-lms"),help:$n("Display a random selection of questions.","sensei-lms"),allowReset:!0,resetLabel:$n("All","sensei-lms"),min:0,max:y,step:1,value:u,placeholder:$n("All","sensei-lms"),onChange:_("showQuestions")})),(0,s.createElement)(ke.Slot,{name:"SenseiQuizSettings"})),!q&&(0,s.createElement)(ke.PanelRow,null,(0,s.createElement)(Wn,null))),(0,s.createElement)(Un,{settings:E,updatePagination:w}),(0,s.createElement)(v.PanelColorSettings,{title:$n("Color settings","sensei-lms"),initialOpen:!1,colorSettings:[{value:h||void 0,onChange:_("buttonTextColor"),label:$n("Button text color","sensei-lms")},{value:b||void 0,onChange:_("buttonBackgroundColor"),label:$n("Button background color","sensei-lms")},{value:(null==E?void 0:E.progressBarColor)||void 0,onChange:function(e){return w({progressBarColor:e})},label:$n("Progress bar color","sensei-lms")},{value:(null==E?void 0:E.progressBarBackground)||void 0,onChange:function(e){return w({progressBarBackground:e})},label:$n("Progress bar background color","sensei-lms")}]})),(0,s.createElement)(v.BlockControls,null,(0,s.createElement)(Gn,{settings:E,updatePagination:w})))};var er=g.__;const tr=function(e){var t=e.totalCount,n=e.completedCount,r=e.hidePercentage,o=e.wrapperAttributes,l=e.barWrapperAttributes,i=e.barAttributes,a=e.countersClassName,c=e.completedCountClassName,u=e.hideDefault,m=e.label,d=Math.round(n/t*100)||0,p=Math.max(u?0:3,d);return(0,s.createElement)("div",o,(0,s.createElement)("section",{className:b()("sensei-progress-bar__heading",a)},(0,s.createElement)("div",{className:b()("sensei-progress-bar__label",c)},(0,g.sprintf)(er("%1$d of %2$d %3$s completed","sensei-lms"),n,t,m||""),!r&&" (".concat(d,"%)"))),(0,s.createElement)("div",P({role:"progressbar","aria-valuenow":d,"aria-valuemin":"0","aria-valuemax":"100"},f(f({},l),{},{className:b()("sensei-progress-bar__bar",null==l?void 0:l.className)})),(0,s.createElement)("div",f(f({},i),{},{className:b()("sensei-progress-bar__progress",null==i?void 0:i.className),style:f(f({},(null==i?void 0:i.style)&&i.style),{},{width:"".concat(p,"%")})}))))};g.__;var nr=g.__;const rr=function(e){var t=e.pagination,n={style:f({},(null==t?void 0:t.progressBarColor)&&{backgroundColor:t.progressBarColor})},r={style:f(f(f({},(null==t?void 0:t.progressBarBackground)&&{backgroundColor:t.progressBarBackground}),(null==t?void 0:t.progressBarHeight)&&{height:t.progressBarHeight}),(null==t?void 0:t.progressBarRadius)&&{borderRadius:t.progressBarRadius})};return(0,s.createElement)(tr,{totalCount:10,completedCount:2,wrapperAttributes:{className:"sensei-lms-quiz-block__progress-bar wp-block"},barAttributes:n,label:nr("questions","sensei-lms"),barWrapperAttributes:r})};var sr=g.__,or=["sensei-lms/quiz-question","sensei-lms/quiz-category-question"];const lr=V((function(e){var t,n,r=e.clientId;!function(e){var t=e.clientId,n=(0,I.useDispatch)(pn),r=n.setBlock,o=n.loadStructure;(0,s.useEffect)((function(){r(t),o()}),[r,o,t])}(e),function(e,t){var n=e.name,r=e.attributes,l=void 0===r?{}:r,i=e.selectFirstBlock,a=void 0!==i&&i,c=e.isEmptyBlock,u=t.clientId,m=(0,I.useDispatch)("core/block-editor"),d=m.__unstableMarkNextChangeAsNotPersistent,p=void 0===d?T.noop:d,f=m.insertBlock,v=(0,I.useSelect)((function(e){return e("core/block-editor").getBlocks(u)})),g=0===v.length,h=(0,s.useCallback)((function(){var e=(0,o.createBlock)(n,l),t=g&&a;p(),f(e,void 0,u,t)}),[p,f,u,n,l,g,a]),b=v.length&&v[v.length-1],E=b&&c(b.attributes);(0,s.useEffect)((function(){E||h()}),[E,h])}({name:zt.name,selectFirstBlock:!e.attributes.isPostTemplate,isEmptyBlock:mn},e),function(e){var t="_quiz_has_questions",n=(0,I.useSelect)((function(t){return t("core/block-editor").getBlocks(e).filter((function(e){return!mn(e.attributes)}))})),r=(0,I.useSelect)((function(e){return{editedValue:e("core/editor").getEditedPostAttribute("meta")[t]}})).editedValue,o=(0,I.useDispatch)("core/editor").editPost,l=(0,s.useCallback)((function(e){return o({meta:d({},t,e?1:0)})}),[o]);(0,s.useEffect)((function(){!r&&n.length&&l(!0),r&&!n.length&&l(!1)}),[n.length,r,l]),(0,s.useEffect)((function(){return function(){l(!1)}}),[l])}(r);var l=R((0,s.useState)(!1),2),i=l[0],a=l[1],c=(0,s.useCallback)((function(){return(0,s.createElement)(qn,{clientId:r,openModal:function(){return a(!0)}})}),[r]),u=null==e||null===(t=e.attributes)||void 0===t||null===(n=t.options)||void 0===n?void 0:n.pagination,m=(null==u?void 0:u.paginationNumber)&&(null==u?void 0:u.showProgressBar);return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(bn,e),(0,s.createElement)("div",{className:"sensei-lms-quiz-block__separator"},(0,s.createElement)("span",null,sr("Lesson Quiz","sensei-lms"))),m&&(0,s.createElement)(rr,{pagination:u}),(0,s.createElement)(v.InnerBlocks,{allowedBlocks:or,templateInsertUpdatesSelection:!1,renderAppender:c}),i&&(0,s.createElement)(Tn,{clientId:r,onClose:function(){return a(!1)}}),(0,s.createElement)("div",{className:"sensei-lms-quiz-block__separator"}),(0,s.createElement)(Xn,e))})),ir=JSON.parse('{"name":"sensei-lms/quiz","category":"sensei-lms","supports":{"html":false,"multiple":false},"attributes":{"id":{"type":"integer"},"options":{"type":"object","default":{"passRequired":false,"quizPassmark":100,"autoGrade":true,"allowRetakes":true,"randomQuestionOrder":false,"showQuestions":null,"failedShowAnswerFeedback":false,"failedShowCorrectAnswers":false,"failedIndicateIncorrect":false,"buttonTextColor":null,"buttonBackgroundColor":null,"pagination":{}}},"isPostTemplate":{"type":"boolean","default":false}}}');var ar=g.__;m([f(f({},ir),{},{title:ar("Quiz","sensei-lms"),icon:en,description:ar("Evaluate progress and strengthen understanding of course concepts.","sensei-lms"),keywords:[ar("Exam","sensei-lms"),ar("Questions","sensei-lms"),ar("Test","sensei-lms"),ar("Assessment","sensei-lms"),ar("Evaluation","sensei-lms")],providesContext:{"sensei-lms/quizId":"id"},example:{innerBlocks:[{name:"sensei-lms/quiz-question",attributes:{title:ar("First Example Question","sensei-lms")}},{name:"sensei-lms/quiz-question",attributes:{title:ar("Second Example Question","sensei-lms")}}]},edit:lr,save:function(){return(0,s.createElement)(v.InnerBlocks.Content,null)}}),zt,Kt,Z,N,x,ae])},1719:(e,t,n)=>{var r=n(2998),s=n(6541),o=s;o.v1=r,o.v4=s,e.exports=o},3973:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,s=t;return[s[e[r++]],s[e[r++]],s[e[r++]],s[e[r++]],"-",s[e[r++]],s[e[r++]],"-",s[e[r++]],s[e[r++]],"-",s[e[r++]],s[e[r++]],"-",s[e[r++]],s[e[r++]],s[e[r++]],s[e[r++]],s[e[r++]],s[e[r++]]].join("")}},6963:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},2998:(e,t,n)=>{var r,s,o=n(6963),l=n(3973),i=0,a=0;e.exports=function(e,t,n){var c=t&&n||0,u=t||[],m=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:s;if(null==m||null==d){var p=o();null==m&&(m=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=s=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:a+1,g=f-i+(v-a)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||f>i)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=f,a=v,s=d;var h=(1e4*(268435455&(f+=122192928e5))+v)%4294967296;u[c++]=h>>>24&255,u[c++]=h>>>16&255,u[c++]=h>>>8&255,u[c++]=255&h;var b=f/4294967296*1e4&268435455;u[c++]=b>>>8&255,u[c++]=255&b,u[c++]=b>>>24&15|16,u[c++]=b>>>16&255,u[c++]=d>>>8|128,u[c++]=255&d;for(var E=0;E<6;++E)u[c+E]=m[E];return t||l(u)}},6541:(e,t,n)=>{var r=n(6963),s=n(3973);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,t)for(var i=0;i<16;++i)t[o+i]=l[i];return t||s(l)}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);n(8132)})();