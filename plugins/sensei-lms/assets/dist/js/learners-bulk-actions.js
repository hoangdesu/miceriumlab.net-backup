jQuery(document).ready((function(){var e,t,i,n,s=jQuery.noConflict();!function(e){var t=s("#bulk-action-user-ids"),i=s("#bulk-action-course-ids"),n=s("#bulk-learner-action-submit"),r=s("#bulk-learner-actions-form"),a=s("#bulk-action-selector-top"),l=s("#sensei-bulk-action"),o=s(".sensei-course-select"),c=s("#bulk-action-course-select"),d=s(".sensei_user_select_id"),u=s("#cb-select-all-1"),v=s(".learner-course-overview-detail"),f=s(".learner-course-overview-detail-btn"),h=s("#cb-select-all-2"),k=s("#sensei-bulk-learner-actions-modal-toggle"),b=s("#sensei-bulk-learner-actions-modal"),p=function(t,i){t.on("click",(function(){e.resetSelectedUserIds(),t.is(":checked")?(i.attr("checked","checked"),d.attr("checked","checked"),d.each((function(t,i){e.updateSelectedUserIdsFromCheckbox(s(i))}))):(d.removeAttr("checked"),i.removeAttr("checked")),I()}))},I=function(){var t=e.validator(),i=t.validateBulkAction(),n=t.validateSelectedUserIds();i.isValid&&n.isValid?k.removeAttr("disabled"):k.attr("disabled",!0)};o.select2({placeholder:window.sensei_learners_bulk_data.select_course_placeholder,width:"300px"}),d.on("change",(function(t){var i=s(this);t.preventDefault(),t.stopPropagation(),e.updateSelectedUserIdsFromCheckbox(i),I()})),p(u,h),p(h,u),k.attr("disabled",!0),k.on("click",(function(){return b.modal({fadeDuration:100,fadeDelay:.5}),!1})),f.on("click",(function(e){e.preventDefault(),e.stopPropagation();var t=s(this).siblings(".learner-course-overview-detail").first();v.filter(":visible").slideUp("slow"),t.is(":hidden")?t.slideDown("slow"):t.slideUp("slow")})),a.on("change",(function(){l.val(a.val().trim()),e.setAction(l.val()),I()})),c.on("change",(function(){e.setCourseIds(c.val()).validator().validateCourseIds().isValid?n.removeAttr("disabled"):n.attr("disabled",!0)})),n.attr("disabled",!0),n.on("click",(function(n){n.preventDefault(),n.stopPropagation(),e.setCourseIds(c.val()).setAction(l.val().trim()),e.validate().isValid&&(t.val(e.getUserIds().join(",")),i.val(c.val().join(",")),r.submit())}))}((e=[],t=[],i="",n={isValid:!0,reason:""},{updateSelectedUserIdsFromCheckbox:function(t){var i=parseInt(t.val(),10),n=e.indexOf(i);return t.is(":checked")?n<0&&e.push(i):n>-1&&e.splice(n,1),this},getUserIds:function(){return e},setAction:function(e){return i=e,this},setCourseIds:function(e){var i,n,r;return i=e,n=function(e){return parseInt(e,10)},r=[],s.each(i,(function(e,t){r.push(n(t))})),t=r,this},resetSelectedUserIds:function(){return e=[],this},resetAll:function(){return this.resetSelectedUserIds(),t=[],i="",this},validator:function(){return{validateBulkAction:function(){return""==i?{isValid:!1,reason:"Select an action"}:n},validateCourseIds:function(){return 0===(e=t,i=function(e){return!isNaN(e)},r=[],s.each(e,(function(e,t){i(t)&&r.push(t)})),r).length?{isValid:!1,reason:"Select a course"}:n;var e,i,r},validateSelectedUserIds:function(){return 0===e.length?{isValid:!1,reason:"Select some learners"}:n},validate:function(){for(var e,t=[this.validateSelectedUserIds,this.validateBulkAction,this.validateCourseIds];t.length>0;)if(!(e=t.shift().call(this)).isValid)return e;return n}}},validate:function(){return this.validator().validate()}}))}));